d2 <-
gather(data = d1,
key =   居住形態,
value =  x,
一人暮らし ,
配偶者 ,
家族)  %>% filter(x != 0) %>% arrange(id) %>% left_join(., d, by = "id") %>%
select(-x)
# d2$SEX %>% factor(labels = c("男性","女性"))
# d2$JOB %>% factor(labels =c("学生","その他"))
# d2$料理人 %>% factor(labels =)
# d2$購入人 %>% factor(labels =c("ご自身","配偶者","家族"))
d2 <- d2 %>%
select(id:JOB,   朝食の頻度:購入人) %>%
mutate(
SEX = factor(SEX, labels = c("男性", "女性")),
JOB = factor(JOB, labels = c("その他", "学生")),
料理人  = factor(料理人, labels = c("ご自身", "配偶者", "家族")) ,
購入人  = factor(購入人, labels = c("ご自身", "配偶者", "家族"))
) %>%
select(id:JOB,   料理人,   購入人, everything())
d2
suppressMessages(library(tidyverse))
# setwd("C:/Users/uasami reo/Downloads/マクロミル/07_カゴメ部門(FIX)/分析用データ/アンケートデータ/01_ローデータ/01_スクリーニングデータ")
d <- read.csv("data.for.analysis.csv", fileEncoding = "cp932") %>%
tbl_df()
d1 <- d %>% select(id,   一人暮らし:家族)
d1
d2 <-
gather(data = d1,
key =   居住形態,
value =  x,
一人暮らし ,
配偶者 ,
家族)  %>% filter(x != 0) %>% arrange(id) %>% left_join(., d, by = "id") %>%
select(-x)
# d2$SEX %>% factor(labels = c("男性","女性"))
# d2$JOB %>% factor(labels =c("学生","その他"))
# d2$料理人 %>% factor(labels =)
# d2$購入人 %>% factor(labels =c("ご自身","配偶者","家族"))
d2 <- d2 %>%
select(id:JOB,   朝食の頻度:購入人) %>%
mutate(
SEX = factor(SEX, labels = c("男性", "女性")),
JOB = factor(JOB, labels = c("その他", "学生")),
料理人  = factor(料理人, labels = c("ご自身", "配偶者", "家族")) ,
購入人  = factor(購入人, labels = c("ご自身", "配偶者", "家族"))
) %>%
select(id:JOB,   料理人,   購入人, everything())
d2
d
d
d2
t.test(d2$朝食の頻度~d2$SEX)
t.test(d2$朝食の頻度~d2$SEX)
d2
d2
cor(d2$朝食の頻度, d2$日食の頻度)
plot(d2$朝食の頻度, d2$日食の頻度)
plot(d2$朝食の頻度, d2$日食の頻度)
lm(朝食の頻度~., data=d2)
lm(朝食の頻度~., data=d2)
lm(朝食の頻度~., data=d2)
lm(朝食の頻度~居住形態, data=d2)
anova(lm(朝食の頻度~居住形態, data=d2))
anova(lm(朝食の頻度~居住形態, data=d2))
lm(朝食の頻度~居住形態, data=d2)
d2
t<-read.csv("total.csv")
t
t.test(t$購入率~t$sex)
library(tidyverse)
t.test(t$購入率~t$sex) %>% tidy()
# 購入系
t<-read.csv("total.csv")
cor(t$金額シェア,t$購入率)
cor(t$累積シェア,t$購入率)
cor(t$購入者あたり購入金額,t$購入率)
t.test(t$購入率~t$sex) %>% tidy()
t.test(t$購入率~t$sex) %>% glance()
library(tidyverse)
t.test(t$購入率~t$sex) %>% glance()
library(purrr)
t.test(t$購入率~t$sex) %>% glance()
library(broom)
# 購入系
t<-read.csv("total.csv")
cor(t$金額シェア,t$購入率)
cor(t$累積シェア,t$購入率)
cor(t$購入者あたり購入金額,t$購入率)
t.test(t$購入率~t$sex) %>% glance()
t.test(t$購入率~t$sex) %>% tidy()
summary(t$購入率~t$sex) %>% tidy()
summary(t$購入率~t$sex)
mean(t$購入率~t$sex)
t %>% select(購入率, sex)
t %>% select(購入率, sex) %>% group_by(sex)
t %>% select(購入率, sex) %>% group_by(sex) %>% summarise(mean(購入率))
suppressMessages(library(tidyverse))
# setwd("C:/Users/uasami reo/Downloads/マクロミル/07_カゴメ部門(FIX)/分析用データ/アンケートデータ/01_ローデータ/01_スクリーニングデータ")
d <- read.csv("data.for.analysis.csv", fileEncoding = "cp932") %>%
tbl_df()
d1 <- d %>% select(id,   一人暮らし:家族)
d1
d2 <-
gather(data = d1,
key =   居住形態,
value =  x,
一人暮らし ,
配偶者 ,
家族)  %>% filter(x != 0) %>% arrange(id) %>% left_join(., d, by = "id") %>%
select(-x)
# d2$SEX %>% factor(labels = c("男性","女性"))
# d2$JOB %>% factor(labels =c("学生","その他"))
# d2$料理人 %>% factor(labels =)
# d2$購入人 %>% factor(labels =c("ご自身","配偶者","家族"))
d2 <- d2 %>%
select(id:JOB,   朝食の頻度:購入人) %>%
mutate(
SEX = factor(SEX, labels = c("男性", "女性")),
JOB = factor(JOB, labels = c("その他", "学生")),
料理人  = factor(料理人, labels = c("ご自身", "配偶者", "家族")) ,
購入人  = factor(購入人, labels = c("ご自身", "配偶者", "家族"))
) %>%
select(id:JOB,   料理人,   購入人, everything())
d2
d2
t.test(d2$朝食の頻度~d2$SEX)
t.test(d2$朝食の頻度~d2$JOB)
cor(t$金額シェア,t$購入率)
cor(t$累積シェア,t$購入率)
cor(t$購入者あたり購入金額,t$購入率)
t.test(t$購入率~t$sex) %>% tidy()
t %>% select(購入率, sex) %>% group_by(sex) %>% summarise(mean(購入率))
t.test(t$購入率~t$sex)
t.test(t$購入率~t$sex) %>% str()
t.test(t$購入率~t$sex) %>% .$p.value
t.test(t$購入率~t$sex) %>% .$p.value %>% round(2)
t.test(t$購入率~t$sex) %>% .$p.value %>% round(5)
t.test(t$購入率~t$sex)
t %>% select(購入率, sex) %>% group_by(sex) %>% summarise(mean(購入率))
t %>% select(購入率, sex) %>% group_by(sex) %>% summarise(mean(購入率)) %>% round(2)
t.test(d2$朝食の頻度~d2$SEX)
cor(d2$朝食の頻度, d2$日食の頻度)
t %>% select(アイテム, 購入率)
syuinbunseki<-read.csv("total.csv")
syuinbunseki
hindo<-syuinbunseki%>%select(購入率,カテゴリー)
hindo
suppressMessages(library(tidyverse))
suppressMessages(library(broom))
# 購入系
t<-read.csv("total.csv")
#主成分分析
syuinbunseki<-read.csv("total.csv")
hindo<-syuinbunseki%>%select(購入率,カテゴリー)
syuinbunseki %>% colnames()
# install.packages("dplyr")
suppressMessages(library(dplyr))
# setwd("C:/Users/uasami reo/Downloads/マクロミル/07_カゴメ部門(FIX)/分析用データ/アンケートデータ/01_ローデータ/01_スクリーニングデータ")
### pre processing start ###
kagome <- read.csv("978145_rawdata.csv", fileEncoding = "cp932")
kagome.survey <-
kagome %>% select(-AGEID,-AREA,-Q1_14FA, -ANSWERDATE, -CELL, -SAMPLEID, -CELLNAME, -Q6_6FA, -Q7_6FA) %>%
mutate(id = 1:nrow(.)) %>%
select(id, everything())
attach(kagome.survey)
Q2_t <- (Q2S1 + Q2S4) / 2
Q2_n <- (Q2S2 + Q2S3 + Q2S5 + Q2S6) / 4
Q3_t <- (Q3S1 + Q3S4) / 2
Q3_n <- (Q3S2 + Q3S3 + Q3S5 + Q3S6) / 4
Q4_t <- (Q4S1 + Q4S4) / 2
Q4_n <-  (Q4S2 + Q4S3 + Q4S5 + Q4S6) /  4
Q5_t <- (Q5S1 + Q5S4) / 2
Q5_n <-  (Q5S2 + Q5S3 + Q5S5 + Q5S6) / 4
kagome.survey <-
kagome.survey %>%
select(-Q2S1:-Q5S6) %>% tbl_df
kagome.survey <-
kagome.survey %>% mutate(Q2_t, Q2_n, Q3_t, Q3_n, Q4_t, Q4_n, Q5_t, Q5_n)%>%
select(
id,
SEX,
AGE,
PREFECTURE,
JOB,
Q1_1:Q1_14,
Q2_t,
Q2_n,
Q3_t,
Q3_n,
Q4_t,
Q4_n,
Q5_t,
Q5_n,
everything()
)
#もっと変数減らしたりする
kagome.survey %>% tbl_df()
#JOBを学生=1とそれ以外=0にする
kagome.survey$JOB <-
ifelse(kagome.survey$JOB < 10 | kagome.survey$JOB > 10 , 0, 1)
#↑学生少なすぎるけど、大丈夫かな、、、
#Q1の変数を"1人暮らし","配偶者","家族"の3つにする
kagome.survey <-
kagome.survey %>% mutate(一人暮らし = Q1_1) %>% select(-Q1_1) %>%
mutate(配偶者 = Q1_2) %>% select(-Q1_2) %>%
mutate(家族 = Q1_3 + Q1_4 + Q1_5 + Q1_6 + Q1_7 + Q1_8 + Q1_9 + Q1_10 + Q1_11 +
Q1_12 + Q1_13) %>%
select(-Q1_3:-Q1_13)
#"その他"のQ1_14も削除
kagome.survey <- kagome.survey %>% select(-Q1_14)
kagome.survey <-
kagome.survey %>% select(id, SEX, AGE, PREFECTURE, JOB, 一人暮らし, 配偶者, 家族, everything())
#家族のとこの1より大きい数字は1にする
kagome.survey$家族  <-  ifelse(kagome.survey$家族  > 1, 1, kagome.survey$家族)
# Q2~Q5に reverse codingする（1が良いことなので）
kagome.survey$Q2_t <- 9 - kagome.survey$Q2_t
kagome.survey$Q2_n <- 9 - kagome.survey$Q2_n
kagome.survey$Q3_t <- 9 - kagome.survey$Q3_n
kagome.survey$Q3_n <- 9 - kagome.survey$Q3_n
kagome.survey$Q4_t <- 9 - kagome.survey$Q4_t
kagome.survey$Q4_n <- 9 - kagome.survey$Q4_n
kagome.survey$Q5_t <- 9 - kagome.survey$Q5_t
kagome.survey$Q5_n <- 9 - kagome.survey$Q5_n
kagome.survey$朝食の頻度  <- kagome.survey$Q2_t
kagome.survey$日食の頻度  <- kagome.survey$Q2_n
kagome.survey$外朝食の頻度  <- kagome.survey$Q3_t
kagome.survey$外日食の頻度  <- kagome.survey$Q3_n
kagome.survey$内朝食の頻度  <- kagome.survey$Q4_t
kagome.survey$内日食の頻度  <- kagome.survey$Q4_n
kagome.survey$作朝食の頻度  <- kagome.survey$Q5_t
kagome.survey$作日食の頻度  <- kagome.survey$Q5_n
kagome.survey <-
kagome.survey %>% select(-Q2_t, -Q2_n, -Q3_t, -Q3_n, -Q4_t, -Q4_n, -Q5_t, -Q5_n)
kagome.survey <-
kagome.survey %>% select(
id,
SEX,
AGE,
PREFECTURE,
JOB,
一人暮らし,
配偶者,
家族,
朝食の頻度,
日食の頻度,
外朝食の頻度,
外日食の頻度,
内朝食の頻度,
内日食の頻度,
作朝食の頻度,
作日食の頻度,
everything()
)
#Q6,Q7を自分：1、配偶者：2、家族：3にしたい
kagome.survey$料理人  <- ifelse(kagome.survey$Q6 == 1 ,
"自分",
ifelse(kagome.survey$Q6 == 2 , "配偶者",
"家族"))
kagome.survey$購入人  <- ifelse(kagome.survey$Q6 == 1 ,
"自分",
ifelse(kagome.survey$Q6 == 2 , "配偶者",
"家族"))
kagome.survey <- kagome.survey %>% select(-Q6, -Q7)
kagome.survey %>% tbl_df()
kagome.survey
kagome.survey %>% tbl_df()
頻度 <- kagome.survey %>% select(朝食の頻度,日食の頻度,外朝食の頻度,外日食の頻度,内朝食の頻度,内日食の頻度,作朝食の頻度,作日食の頻度)
頻度 <- scale(頻度)
頻度
相関行列頻度 <- cor(頻度)
相関行列頻度
固有値頻度 <- eigen(相関行列頻度)
固有値頻度
対角化固有値頻度 <- diag(固有値頻度$values)
頻度の固有ベクトル <- 固有値頻度$vectors
対角化固有値頻度
頻度の固有ベクトル
頻度 <- kagome.survey %>% select(朝食の頻度,日食の頻度,外朝食の頻度,外日食の頻度,内朝食の頻度,内日食の頻度,作朝食の頻度,作日食の頻度)
頻度
頻度
頻度 <- scale(頻度)
頻度
相関行列頻度 <- cor(頻度)
相関行列頻度
固有値頻度 <- eigen(相関行列頻度)
固有値頻度
相関行列頻度
頻度
相関行列頻度 <- cor(頻度, use = "complete.obs")
相関行列頻度
固有値頻度 <- eigen(相関行列頻度)
対角化固有値頻度 <- diag(固有値頻度$values)
頻度の固有ベクトル <- 固有値頻度$vectors
library(knitr)
種目 <- c("朝食の頻度","日食の頻度","外朝食の頻度","外日食の頻度","内朝食の頻度","内日食の頻度","作朝食の頻度","作日食の頻度")
頻度の主成分 <- data.frame("頻度"=頻度,"第1主成分"=頻度の固有ベクトル[,1],"第2主成分"=頻度の固有ベクトル[,2])
kable(頻度の主成分,format="markdown")
頻度の主成分
頻度
pac(頻度)
pca(頻度)
prcomp(頻度)
相関行列頻度
prcomp(相関行列頻度)
prcomp(相関行列頻度)  %>% select(1, 2)
prcomp(相関行列頻度) %>% biplot()
prcomp(相関行列頻度) %>% biplot()
par(family = "HiraKakuProN-W3")
prcomp(相関行列頻度) %>% biplot()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
par(family = "HiraKakuProN-W3")
prcomp(相関行列頻度) %>% biplot()
相関行列頻度
par(family = "HiraKakuProN-W3")
prcomp(covmat=相関行列頻度) %>% biplot()
par(family = "HiraKakuProN-W3")
prcomp(covmat=as.matrix(相関行列頻度)) %>% biplot()
prcomp(as.matrix(相関行列頻度)) %>% biplot()
?prcomp
prcomp(頻度)
prcomp(頻度)
?prcomp
頻度
頻度 <- kagome.survey %>% select(朝食の頻度,日食の頻度,外朝食の頻度,外日食の頻度,内朝食の頻度,内日食の頻度,作朝食の頻度,作日食の頻度)
prcomp(頻度)
prcomp(頻度, scale. = T)
prcomp(頻度)
頻度
頻度 <- scale(頻度) %>% matrix()
頻度
prcomp(頻度)
prcomp(頻度)
頻度
頻度
頻度 <- kagome.survey %>% select(朝食の頻度,日食の頻度,外朝食の頻度,外日食の頻度,内朝食の頻度,内日食の頻度,作朝食の頻度,作日食の頻度)
頻度
final[complete.cases(頻度), ]
頻度[complete.cases(頻度), ]
頻度[complete.cases(頻度), ] %>% prcomp()
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot()
頻度[complete.cases(頻度), ] %>% prcomp() %>% tidy()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
頻度 <- kagome.survey %>% select(朝食の頻度,日食の頻度,外朝食の頻度,外日食の頻度,内朝食の頻度,内日食の頻度,作朝食の頻度,作日食の頻度)
頻度 <- kagome.survey %>% select(朝食の頻度,日食の頻度,外朝食の頻度,外日食の頻度,内朝食の頻度,内日食の頻度,作朝食の頻度,作日食の頻度)
頻度
頻度[complete.cases(頻度), ] %>% prcomp() %>% tidy()
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot()
頻度
kagome.survey
頻度 <- kagome.survey %>%
select(SEX, 朝食の頻度,日食の頻度,外朝食の頻度,外日食の頻度,内朝食の頻度,内日食の頻度,作朝食の頻度,作日食の頻度)
頻度
頻度 %>% group_by(SEX) %>% summarise_at(朝食の頻度, mean())
頻度 %>% group_by(SEX) %>%
summarise_each(dplyr::funs(sum))
頻度 %>% group_by(SEX) %>%
summarise_each(funs(mean))
頻度 %>% group_by(SEX) %>%
summarise_each(funs(mean))
?mean
頻度 %>% group_by(SEX) %>%
summarise_each(funs(mean(na.rm=T)))
頻度 %>% group_by(SEX) %>%
summarise_each(funs(mean(., na.rm=T)))
頻度 %>% group_by(SEX) %>%
summarise_each(funs(mean(., na.rm=T)))
頻度
頻度 %>% group_by(SEX) %>%
summarise_each(funs(mean(., na.rm=T)))
dir()
kagome.survey<-read.csv(file = "data.for.analysis.csv", fileEncoding = "cp932")
kagome.survey
kagome.survey<-read.csv(file = "data.for.analysis.csv", fileEncoding = "cp932")
頻度 <- kagome.survey %>%
select(SEX, 朝食の頻度,日食の頻度,外朝食の頻度,外日食の頻度,内朝食の頻度,内日食の頻度,作朝食の頻度,作日食の頻度)
library(tidyverse)
suppressMessages(library(tidyverse))
kagome.survey<-read.csv(file = "data.for.analysis.csv", fileEncoding = "cp932")
suppressMessages(library(tidyverse))
kagome.survey<-read.csv(file = "data.for.analysis.csv", fileEncoding = "cp932")
頻度 <- kagome.survey %>%
select(SEX, 朝食の頻度,日食の頻度,外朝食の頻度,外日食の頻度,内朝食の頻度,内日食の頻度,作朝食の頻度,作日食の頻度)
頻度
頻度 <- kagome.survey %>%
select(SEX, 朝食の頻度,日食の頻度,外朝食の頻度,外日食の頻度,内朝食の頻度,内日食の頻度,作朝食の頻度,作日食の頻度) %>%
tbl_df()
頻度
頻度 %>% group_by(SEX) %>%
summarise_each(funs(mean(., na.rm=T)))
頻度 %>% group_by(SEX) %>%
summarise_each(funs(~mean(., na.rm=T)))
頻度 %>% group_by(SEX) %>%
summarise_each(funs(mean(., na.rm=T)))
kagome.survey
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot()
x11()
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
x11()
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot()
dev.off()
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot()
頻度[complete.cases(頻度), ]
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot()
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot()
x11()
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot()
x11()
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot()
x11()
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot()
suppressMessages(library(tidyverse))
kagome.survey<-read.csv(file = "data.for.analysis.csv", fileEncoding = "cp932")
頻度 <- kagome.survey %>%
select(SEX, 朝食の頻度,日食の頻度,外朝食の頻度,外日食の頻度,内朝食の頻度,内日食の頻度,作朝食の頻度,作日食の頻度) %>%
tbl_df()
頻度 %>% group_by(SEX) %>%
summarise_each(funs(mean(., na.rm=T)))
x11()
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot()
x11()
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot()
iris %>% plot()
x11()
iris %>% plot()
x11()
iris %>% plot()
iris %>% plot()
x11()
iris %>% plot()
x11()
iris %>% plot()
x11()
iris %>% plot()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
頻度[complete.cases(頻度), ]
頻度[complete.cases(頻度), ] %>% prcomp()
頻度[complete.cases(頻度), ] %>% prcomp() %>% x11() %>% biplot
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
iris %>% plot()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
x11()
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
x11()
頻度[complete.cases(頻度), ] %>% prcomp() %>% biplot
